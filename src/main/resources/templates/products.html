<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Våra böcker</title>
    <link rel="stylesheet" type="text/css" th:href="@{/styles.css}">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
<div class="container">
    <h1>Product Catalog</h1>
    <div>Number of Products: <span id="productCount"></span></div>

    <!-- Knappar för olika kategorier -->
    <div>
        <a href="/interaktiva_barnbocker"><button>Interaktiva barnböcker</button></a>
        <a href="/signerade_forstautgavor"><button>Signerade förstautgåvor</button></a>
        <a href="/sallsynta_fantasyserier"><button>Sällsynta fantasyserier</button></a>
    </div>

    <!-- Filter- och sorteringsknappar -->
    <div>
        <button id="filterByPriceAsc">Lägst-högst pris</button>
        <button id="filterByPriceDesc">Högst-lägst pris</button>
    </div>

    <!-- Visa alla produkter -->
    <div id="productList" class="product-list">
        <!-- Produkterna visas här dynamiskt -->
    </div>
</div>

<script>
    // Funktion för att hämta och visa produkter baserat på sorteringsordning
    function fetchAndDisplayProducts(order) {
        $.get("/sortByPrice", {order: order}, function(products) {
            var productListHtml = "";
            products.forEach(function(product) {
                productListHtml += "<div class='product'>";
                productListHtml += "<h2>" + product.title + "</h2>";
                productListHtml += "<p><strong>Author:</strong> " + product.author + "</p>";
                productListHtml += "<p><strong>Description:</strong> " + product.description + "</p>";
                productListHtml += "<p><strong>Year:</strong> " + product.year + "</p>";
                productListHtml += "<p><strong>Category:</strong> " + product.category + "</p>";
                productListHtml += "<p><strong>Item Number:</strong> " + product.itemNumber + "</p>";
                productListHtml += "<p><strong>Price:</strong> " + product.price + " kr</p>";
                productListHtml += "<form action='/cart/add/" + product.id + "' method='post'>";
                productListHtml += "<button type='submit'>Köp</button>";
                productListHtml += "</form>";
                productListHtml += "<a href='/product_card.html'><button type='button'>Läs mer</button></a>";
                productListHtml += "</div>";
            });
            $("#productList").html(productListHtml);
            $("#productCount").text(products.length);
        });
    }

    // Klickhändelse för "Lägst-högst pris" knappen
    $("#filterByPriceAsc").click(function() {
        fetchAndDisplayProducts("asc");
    });

    // Klickhändelse för "Högst-lägst pris" knappen
    $("#filterByPriceDesc").click(function() {
        fetchAndDisplayProducts("desc");
    });

    // Ladda produkter vid sidans start
    $(document).ready(function() {
        fetchAndDisplayProducts("asc"); // Visa produkter sorterade i stigande ordning som standard
    });
</script>

</body>
</html>
